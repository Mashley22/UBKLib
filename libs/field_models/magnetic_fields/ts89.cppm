module;

#include <array>
#include <concepts>

export module UBKLib.field_models:magnetic_fields.ts89;

import :traits;
import UBKLib.utils;

namespace ubk {

// NOTE NEED TO BE CAREFUL OF FLOATING POINT MATH STUFF, SHOULD BE FINE BUT YOU NEVER KNOW
// For ease of comparing to original will provide both big fuck off param tables as well as
// proper named variables, following the geopack python implementation
// C ordering has been used, although its constexpr so really should not be affecting performance
// may be some llm hallucination here but oh well
template<std::floating_point T>
class Ts89 { 
public:

  T param[7][30] = {
  {
    -116.53, -10719, 42.375, 59.753, -11363, 1.7844, 30.268,
    -0.035372, -0.066832, 0.016456, -1.3024, 0.0016529, 0.0020293, 20.289,
    -0.025203, 224.91, -9234.8, 22.788, 7.8813, 1.8362, -0.27228,
    8.8184, 2.8714, 14.468, 32.177, 0.01, 0, 7.0459,
    4, 20
  },
  {
    -55.553, -13198, 60.647, 61.072, -16064, 2.2534, 34.407,
    -0.038887, -0.094571, 0.027154, -1.3901, 0.001346, 0.0013238, 23.005,
    -0.030565, 55.047, -3875.7, 20.178, 7.9693, 1.4575, 0.89471,
    9.4039, 3.5215, 14.474, 36.555, 0.01, 0, 7.0787,
    4, 20
  },
  {
    -101.34, -13480, 111.35, 12.386, -24699, 2.6459, 38.948,
    -0.03408, -0.12404, 0.029702, -1.4052, 0.0012103, 0.0016381, 24.49,
    -0.037705, -298.32, 4400.9, 18.692, 7.9064, 1.3047, 2.4541,
    9.7012, 7.1624, 14.288, 33.822, 0.01, 0, 6.7442,
    4, 20
  },
  {
    -181.69, -12320, 173.79, -96.664, -39051, 3.2633, 44.968,
    -0.046377, -0.16686, 0.048298, -1.5473, 0.0010277, 0.0031632, 27.341,
    -0.050655, -514.1, 12482, 16.257, 8.5834, 1.0194, 3.6148,
    8.6042, 5.5057, 13.778, 32.373, 0.01, 0, 7.3195,
    4, 20
  },
  {
    -436.54, -9001, 323.66, -410.08, -50340, 3.9932, 58.524,
    -0.038519, -0.26822, 0.074528, -1.4268, -0.0010985, 0.0096613, 27.557,
    -0.056522, -867.03, 20652, 14.101, 8.3501, 0.72996, 3.8149,
    9.2908, 6.4674, 13.729, 28.353, 0.01, 0, 7.4237,
    4, 20
  },
  {
    -707.77, -4471.9, 432.81, -435.51, -60400, 4.6229, 68.178,
    -0.088245, -0.21002, 0.11846, -2.6711, 0.0022305, 0.01091, 27.547,
    -0.05408, -424.23, 1100.2, 13.954, 7.5337, 0.89714, 3.7813,
    8.2945, 5.174, 14.213, 25.237, 0.01, 0, 7.0037,
    4, 20
  },
  {
    -1190.4, 2749.9, 742.56, -1110.3, -77193, 7.6727, 102.05,
    -0.096015, -0.74507, 0.11214, -1.3614, 0.0015157, 0.022283, 23.164,
    -0.074146, -2219.1, 48253, 12.714, 7.6777, 0.57138, 2.9633,
    9.3909, 9.7263, 11.123, 21.558, 0.01, 0, 4.4518,
    4, 20
  }
};


  [[nodiscard]] Vector3<microTesla<T>>
  getField(Vector3<T> pos) const {
    throw;
    return pos;
  }
};

}
